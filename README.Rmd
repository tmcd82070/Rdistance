---
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE
  , echo = FALSE
  , comment = "#>"
  , fig.path = "README_files/README-"
  , out.width = "100%"
)
includeFigure = function(x) {
  knitr::include_graphics(file.path("README_files", x))
}
```

```{r}
includeFigure("RdistanceTopBanner.PNG")
```

<!-- badges: start -->
[![CRAN Version](http://www.r-pkg.org/badges/version/Rdistance)](http://www.r-pkg.org/pkg/Rdistance)
[![CRAN Downloads](http://cranlogs.r-pkg.org/badges/Rdistance)](http://cran.rstudio.com/web/packages/Rdistance/index.html)
[![Travis-CI Build Status](https://travis-ci.org/tmcd82070/Rdistance.svg?branch=master)](https://travis-ci.org/tmcd82070/Rdistance)
[![CRAN Total Downloads](http://cranlogs.r-pkg.org/badges/grand-total/Rdistance)](http://www.r-pkg.org/pkg/Rdistance)
[![codecov](https://codecov.io/gh/tmcd82070/Rdistance/branch/master/graph/badge.svg)](https://codecov.io/gh/tmcd82070/Rdistance)
<!-- badges: end -->

# Simplified Distance-Sampling in R

**Rdistance** analyzes line- and point-transect distance-sampling data. 
If you are unfamiliar with 
distance-sampling, check out our primer, [Distance Sampling 
for the Average Joe](https://github.com/tmcd82070/Rdistance/wiki/avgJoeIntro.Rmd). 
For those ready to take on 
an analysis, the best place to start is one of our vignettes or in the **Examples** section (below).

**Vignettes**:

* [Beginner Line Transects]{Rdistance-BeginnerLineTransect.Rmd}
* [Extended Beginner Line Transects Examples]{Extended_dfuncEstim_Examples.Rmd}

```{r}
includeFigure("RdistanceSeparator.PNG")
```

## Features

* Line-transect and point-transects 
* Likelihood functions: 
  + half-normal (`halfnorm`) 
  + hazard rate (`hazrate`) 
  + negative exponential (`negexp`)
  + Gamma (`Gamma`)
  + logistic (`logistic`)
* Non-parametric smoothed distance functions (`smu`)
* Built-in key functions: `sine`, `cosine`, and `hermite`
* Expansion terms
* Standard methods: `print`, `plot`, `predict`, `AIC`, etc.
* Observation and transect-level distance function covariates
* Standard R formula model specification (e.g., `distance ~ elevation + observer`)
* Measurement unit control and automatic conversion
* Automated bootstrap confidence intervals 
* Overall (study area) abundance estimates
* Custom (user-defined) detection functions
* Help and vignettes reviewed and edited by multiple authors

    
```{r}
includeFigure("RdistanceSeparator.PNG")
```


## Current Release
The current release is [here](https://github.com/tmcd82070/Rdistance/releases).


## Installation

Install the development version from [GitHub](https://github.com/) with:
``` r
if( !require("devtools") ){
  install.packages("devtools")
}
devtools::install_github("tmcd82070/Rdistance")
```

Install the stable version directly from CRAN:

``` r
install.packages("Rdistance")
```


```{r}
includeFigure("RdistanceSeparator.PNG")
```

## Examples 


Examples show the basic workflow of distance-sampling analysis in 
`Rdistance` are on our [Examples wiki page](examples.md)

### Line Transects - No Covariates

```{r sparrowData, echo=TRUE}
if( !require("units") ){
  install.packages("units")
}
library(Rdistance)
library(units)

# Example data
data("sparrowDetectionData")  # access example data
data("sparrowSiteData")
head(sparrowDetectionData)  # inspect data
head(sparrowSiteData)
```

```{r lineHazrateExample, echo=TRUE}
# Set upper (right) truncation distance
whi <- set_units(150, "m")
# Fit hazard rate likelihood
dfuncFit <- dfuncEstim(dist ~ 1
                   , detectionData = sparrowDetectionData
                   , likelihood = "hazrate"
                   , w.hi = whi)
dfuncFit <- abundEstim(dfuncFit
         , detectionData = sparrowDetectionData
         , siteData = sparrowSiteData
         , area = set_units(2500, "hectares"))
print(dfuncFit)
plot(dfuncFit)
```


### Line Transects - With Vegetation Covariate

```{r lineHazrateExampleCovars, echo=TRUE}
dfuncFit <- dfuncEstim(dist ~ bare
                   , detectionData = sparrowDetectionData
                   , siteData = sparrowSiteData
                   , likelihood = "hazrate"
                   , w.hi = whi)
dfuncFit <- abundEstim(dfuncFit
         , detectionData = sparrowDetectionData
         , siteData = sparrowSiteData
         , area = set_units(2500, "hectares")
         , ci=NULL)
print(dfuncFit)
plot(dfuncFit, newdata = data.frame(bare = c(30, 40, 50)), lty = 1)
```

### Point Transects - No Covariates

```{r thrasherData, echo=TRUE}
# Example data
data("thrasherDetectionData")  # access example data
data("thrasherSiteData")
head(thrasherDetectionData)  # inspect example data
head(thrasherSiteData)
```

```{r pointHazrateExample, echo=TRUE}
dfuncFit <- dfuncEstim(dist ~ 1
                   , detectionData = thrasherDetectionData
                   , likelihood = "hazrate"
                   , pointSurvey = TRUE)
dfuncFit <- abundEstim(dfuncFit
         , detectionData = thrasherDetectionData
         , siteData = thrasherSiteData
         , area = set_units(100, "acres"), ci=NULL)
print(dfuncFit)
plot(dfuncFit)
```

### Point Transects - With Vegetation Covariates

```{r pointHazrateExampleCovars, echo=TRUE}
dfuncFit <- dfuncEstim(dist ~ bare + shrub
                   , detectionData = thrasherDetectionData
                   , siteData = thrasherSiteData
                   , likelihood = "hazrate"
                   , pointSurvey = TRUE)
dfuncFit <- abundEstim(dfuncFit
         , detectionData = thrasherDetectionData
         , siteData = thrasherSiteData
         , area = set_units(100, "acres"), ci=NULL)
print(dfuncFit)
plot(dfuncFit, newdata = data.frame(bare = c(30, 35, 40)
                                  , shrub = 20), lty = 1)
```

<!-- github CI examples for auto rendering of Rmd <https://github.com/r-lib/actions/tree/v1/examples>. -->

```{r}
includeFigure("RdistanceSeparator.PNG")
```


# RECENT CHANGES

See our [NEWS](NEWS.Rmd) file for recent changes.


